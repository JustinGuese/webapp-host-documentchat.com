"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[820],{838:(e,t,r)=>{r.d(t,{Ay:()=>u});let a={CHATS:"messenger_chats",CONTACTS:"messenger_contacts",USER_PROFILE:"messenger_user_profile",SETTINGS:"messenger_settings",PROJECTS:"messenger_projects",DOCUMENTS:"messenger_documents"};class n{async save(e,t){try{let{Preferences:a}=await r.e(77).then(r.bind(r,4077));await a.set({key:e,value:JSON.stringify(t)})}catch(t){throw console.error("Error saving data for key ".concat(e,":"),t),t}}async load(e){try{let{Preferences:t}=await r.e(77).then(r.bind(r,4077)),{value:a}=await t.get({key:e});if(!a)return null;return JSON.parse(a)}catch(t){return console.error("Error loading data for key ".concat(e,":"),t),null}}async remove(e){try{let{Preferences:t}=await r.e(77).then(r.bind(r,4077));await t.remove({key:e})}catch(t){throw console.error("Error removing data for key ".concat(e,":"),t),t}}async clear(){try{let{Preferences:e}=await r.e(77).then(r.bind(r,4077));await e.clear()}catch(e){throw console.error("Error clearing all data:",e),e}}async saveChats(e){return this.save(a.CHATS,e)}async loadChats(){return await this.load(a.CHATS)||[]}async saveContacts(e){return this.save(a.CONTACTS,e)}async loadContacts(){return await this.load(a.CONTACTS)||[]}async saveUserProfile(e){return this.save(a.USER_PROFILE,e)}async loadUserProfile(){return this.load(a.USER_PROFILE)}async saveSettings(e){return this.save(a.SETTINGS,e)}async loadSettings(){return await this.load(a.SETTINGS)||{theme:"dark",notifications:!0}}async saveChatMessages(e,t){return this.save("".concat(a.CHATS,"_").concat(e,"_messages"),t)}async loadChatMessages(e){return await this.load("".concat(a.CHATS,"_").concat(e,"_messages"))||[]}async loadChatMessagesPaginated(e,t,r){let a=await this.loadChatMessages(e),n=Math.max(0,a.length-t*r),s=Math.min(a.length,n+r);return a.slice(n,s)}async getMessageCount(e){return(await this.loadChatMessages(e)).length}async deleteChatMessages(e){return this.remove("".concat(a.CHATS,"_").concat(e,"_messages"))}async saveProjects(e){return this.save(a.PROJECTS,e)}async loadProjects(){return await this.load(a.PROJECTS)||[]}async saveDocuments(e){return this.save(a.DOCUMENTS,e)}async loadDocuments(){return await this.load(a.DOCUMENTS)||[]}}class s{async save(e,t){this.map.set(e,JSON.stringify(t))}async load(e){let t=this.map.get(e);return t?JSON.parse(t):null}async remove(e){this.map.delete(e)}async clear(){this.map.clear()}async saveChats(e){return this.save(a.CHATS,e)}async loadChats(){return await this.load(a.CHATS)||[]}async saveContacts(e){return this.save(a.CONTACTS,e)}async loadContacts(){return await this.load(a.CONTACTS)||[]}async saveUserProfile(e){return this.save(a.USER_PROFILE,e)}async loadUserProfile(){return this.load(a.USER_PROFILE)}async saveSettings(e){return this.save(a.SETTINGS,e)}async loadSettings(){return await this.load(a.SETTINGS)||{theme:"dark",notifications:!0}}async saveChatMessages(e,t){return this.save("".concat(a.CHATS,"_").concat(e,"_messages"),t)}async loadChatMessages(e){return await this.load("".concat(a.CHATS,"_").concat(e,"_messages"))||[]}async loadChatMessagesPaginated(e,t,r){let a=await this.loadChatMessages(e),n=Math.max(0,a.length-t*r),s=Math.min(a.length,n+r);return a.slice(n,s)}async getMessageCount(e){return(await this.loadChatMessages(e)).length}async deleteChatMessages(e){return this.remove("".concat(a.CHATS,"_").concat(e,"_messages"))}async saveProjects(e){return this.save(a.PROJECTS,e)}async loadProjects(){return await this.load(a.PROJECTS)||[]}async saveDocuments(e){return this.save(a.DOCUMENTS,e)}async loadDocuments(){return await this.load(a.DOCUMENTS)||[]}constructor(){this.map=new Map}}class o{static async createStorage(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"preferences";switch(e){case"preferences":default:return new n;case"sqlite":case"mongodb":return console.log("MongoDB adapter requested but not implemented - using Preferences instead"),new n}}static createStorageSync(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"preferences";return"preferences"===e||console.log("".concat(e," adapter requested but sync creation only supports preferences - using Preferences instead")),new n}}let i=null;async function l(){if(i)return i;try{i=await o.createStorage("preferences"),console.log("Using preferences storage")}catch(e){console.error("Storage initialization error:",e),i=new s}return i}let u=new Proxy({},{get:(e,t)=>async function(){for(var e=arguments.length,r=Array(e),a=0;a<e;a++)r[a]=arguments[a];let n=await l(),s=n[t];if("function"!=typeof s)throw Error("Storage adapter method ".concat(String(t)," is not a function"));return s.apply(n,r)}})},2521:(e,t,r)=>{r.d(t,{A:()=>E});var a,n,s,o,i,l,u,c=r(2587),d=r(5704);let E={api:{url:(c.Capacitor.isNativePlatform(),d.env.NEXT_PUBLIC_PRODUCTION_URL),timeout:1e4,secret:d.env.NEXT_PUBLIC_API_KEY||""},firebase:{apiKey:null!=(a=d.env.NEXT_PUBLIC_FIREBASE_API_KEY)?a:"",authDomain:null!=(n=d.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN)?n:"",projectId:null!=(s=d.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID)?s:"",appId:null!=(o=d.env.NEXT_PUBLIC_FIREBASE_APP_ID)?o:"",messagingSenderId:null!=(i=d.env.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID)?i:"",storageBucket:null!=(l=d.env.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET)?l:"",measurementId:null!=(u=d.env.NEXT_PUBLIC_FIREBASE_MEASUREMENT_ID)?u:""},notifications:{telegram:{apiKey:d.env.NEXT_PUBLIC_TELEGRAM_API_KEY,chatId:d.env.NEXT_PUBLIC_TELEGRAM_CHAT_ID,apiUrl:d.env.NEXT_PUBLIC_TELEGRAM_API_URL}},revenuecat:{apiKey:d.env.NEXT_PUBLIC_REVENUECAT_API_KEY,apiKeyGoogle:d.env.NEXT_PUBLIC_REVENUECAT_API_KEY_GOOGLE,lifetimeProductId:d.env.NEXT_PUBLIC_REVENUECAT_LIFETIME_PRODUCT_ID,monthlyProductId:d.env.NEXT_PUBLIC_REVENUECAT_MONTHLY_PRODUCT_ID,annuallyProductId:d.env.NEXT_PUBLIC_REVENUECAT_ANNUALLY_PRODUCT_ID,weeklyProductId:d.env.NEXT_PUBLIC_REVENUECAT_WEEKLY_PRODUCT_ID,googleGroupId:d.env.NEXT_PUBLIC_REVENUECAT_GOOGLE_GROUP_ID,googleWeeklyProductId:d.env.NEXT_PUBLIC_REVENUECAT_GOOGLE_WEEKLY_PRODUCT_ID,googleMonthlyProductId:d.env.NEXT_PUBLIC_REVENUECAT_GOOGLE_MONTHLY_PRODUCT_ID,googleLifetimeProductId:d.env.NEXT_PUBLIC_REVENUECAT_GOOGLE_LIFETIME_PRODUCT_ID,googleAnnuallyProductId:d.env.NEXT_PUBLIC_REVENUECAT_GOOGLE_ANNUALLY_PRODUCT_ID},openai:{apiKey:d.env.OPENAI_API_KEY},app:{name:"DocumentChatApp",version:d.env.npm_package_version||"2.0.0",environment:"production"}}},2544:(e,t,r)=>{r.d(t,{AuthProvider:()=>g,Z:()=>C});var a,n=r(5155),s=r(7328),o=r(2521),i=r(8023),l=r(2587),u=r(2078),c=r(9253),d=r(63),E=r(2115);let h=!!(null===o.A||void 0===o.A||null==(a=o.A.firebase)?void 0:a.apiKey)&&!l.Capacitor.isNativePlatform();if(h)try{(0,u.Wp)(o.A.firebase)}catch(e){}let _=(0,E.createContext)(void 0);function g(e){let{children:t}=e,{user:r,loading:a}=(()=>{let[e,t]=(0,E.useState)(null),r=(0,d.usePathname)(),a=h?(0,c.xI)():null,[n,s]=(0,E.useState)(!0);return(0,E.useEffect)(()=>{let e;return(async()=>{if(l.Capacitor.isNativePlatform()){let{user:e}=await i.uo.getCurrentUser();if(e){var r,n;t({uid:null!=(r=e.uid)?r:null,email:null!=(n=e.email)?n:null})}await i.uo.addListener("authStateChange",e=>{if(e.user){var r,a;t({uid:null!=(r=e.user.uid)?r:null,email:null!=(a=e.user.email)?a:null})}else t(null);s(!1)})}else a&&(e=(0,c.hg)(a,e=>{e?t(e):t(null),s(!1)}))})(),()=>{l.Capacitor.isNativePlatform()?i.uo.removeAllListeners():e&&e()}},[a,r]),{user:e,loading:n}})(),[o,u]=E.useState(null),g=E.useMemo(()=>{var e,t,a,n,s,o;return r?{uid:null!=(n=null!=(a=null==r?void 0:r.uid)?a:null==r||null==(e=r.user)?void 0:e.uid)?n:null,email:null!=(o=null!=(s=null==r?void 0:r.email)?s:null==r||null==(t=r.user)?void 0:t.email)?o:null}:null},[r]);E.useEffect(()=>{let e=!1;return(async()=>{if(!r)return u(null);let t=await (0,s.p9)(!1);e||u(t)})(),()=>{e=!0}},[r]);let C=(0,E.useMemo)(()=>({user:g,loading:a,isLoading:a,token:o,async signInWithEmail(e,t){await (0,s.x9)({email:e,password:t}),u(await (0,s.p9)(!1))},async registerWithEmail(e,t){await (0,s.eJ)({email:e,password:t}),u(await (0,s.p9)(!1))},async requestPasswordReset(e){await (0,s.J1)(e)},signOut:s.CI}),[g,a,o]);return(0,n.jsx)(_.Provider,{value:C,children:t})}function C(){let e=(0,E.useContext)(_);if(!e)throw Error("useAuthContext must be used within AuthProvider");return e}},6628:(e,t,r)=>{r.d(t,{d:()=>o,default:()=>i});var a=r(5155),n=r(2115);let s=(0,n.createContext)(null),o=()=>{let e=(0,n.useContext)(s);if(!e)throw Error("useToast must be used within ToastProvider");return e},i=e=>{let{children:t}=e,[r,o]=(0,n.useState)([]),i=(0,n.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",r=String(Date.now())+Math.random().toString(36).slice(2,6),a={id:r,message:e,type:t};o(e=>[a,...e]),setTimeout(()=>{o(e=>e.filter(e=>e.id!==r))},4500)},[]);return(0,a.jsxs)(s.Provider,{value:{show:i},children:[t,(0,a.jsx)("div",{className:"fixed bottom-6 right-4 z-50 flex flex-col gap-2",children:r.map(e=>(0,a.jsx)("div",{className:"px-4 py-2 rounded-lg shadow-md text-sm text-white ".concat("success"===e.type?"bg-green-500":"error"===e.type?"bg-red-500":"bg-blue-500"),children:e.message},e.id))})]})}},7328:(e,t,r)=>{r.d(t,{CI:()=>y,G6:()=>v,J1:()=>g,Wm:()=>E,eJ:()=>d,p9:()=>_,x9:()=>C});var a,n=r(2521),s=r(8023),o=r(2587),i=r(2078),l=r(9253);let u=o.Capacitor.isNativePlatform(),c=!!(null===n.A||void 0===n.A||null==(a=n.A.firebase)?void 0:a.apiKey)&&!u;if(c)try{(0,i.Wp)(n.A.firebase)}catch(e){}let d=async e=>{let{email:t,password:r}=e;try{if(u)return(await s.uo.createUserWithEmailAndPassword({email:t,password:r})).user;if(c){let e=(0,l.xI)();return(await (0,l.eJ)(e,t,r)).user}throw Error("Firebase not configured for this platform")}catch(e){throw console.error("Failed to create user:",e),e}},E=async e=>{try{return(await s.uo.fetchSignInMethodsForEmail({email:e})).signInMethods||[]}catch(e){throw console.error("Failed to fetch sign-in methods:",e),e}},h=async()=>{try{if(u)return(await s.uo.getCurrentUser()).user;if(c)return(0,l.xI)().currentUser;return null}catch(e){return console.error("Failed to get current user:",e),null}},_=async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{if(u){if(!await h())return null;return(await s.uo.getIdToken({forceRefresh:e})).token}if(c){let t=(0,l.xI)().currentUser;if(!t)return null;return await t.getIdToken(e)}return null}catch(e){return console.error("Failed to get ID token:",e),null}},g=async e=>{try{if(u)return void await s.uo.sendPasswordResetEmail({email:e});if(c){let t=(0,l.xI)();await (0,l.J1)(t,e);return}throw Error("Firebase not configured for this platform")}catch(e){throw console.error("Failed to send password reset email:",e),e}},C=async e=>{let{email:t,password:r}=e;try{if(u)return(await s.uo.signInWithEmailAndPassword({email:t,password:r})).user;if(c){let e=(0,l.xI)();return(await (0,l.x9)(e,t,r)).user}return null}catch(e){throw console.error("Failed to sign in with email and password:",e),e}},v=async()=>{try{if(u)return(await s.uo.signInWithGoogle()).user;if(c){let e=(0,l.xI)(),t=new l.HF;return(await (0,l.df)(e,t)).user}return null}catch(e){throw console.error("Failed to sign in with Google:",e),e}},y=async()=>{try{if(u)return void await s.uo.signOut();if(c){let e=(0,l.xI)();await e.signOut()}return}catch(e){throw console.error("Failed to sign out:",e),e}}}}]);